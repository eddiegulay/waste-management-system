{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %} My Dashboard{% endblock %}

{% block body %}
<body class="sb-nav-fixed">


    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
        <!-- Navbar Brand-->
        <a class="navbar-brand ps-3" href="index.html">My Dashboard</a>
        <!-- Sidebar Toggle-->
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
        <!-- Navbar Search-->
        <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
            <div class="input-group">
                <input class="form-control" type="text" placeholder="Search for..." aria-label="Search for..." aria-describedby="btnNavbarSearch" />
                <button class="btn btn-primary" id="btnNavbarSearch" type="button"><i class="fas fa-search"></i></button>
            </div>
        </form>
        <!-- Navbar-->
        <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                    <li><a class="dropdown-item" href="/sign_out">Logout</a></li>
                </ul>
            </li>
        </ul>
    </nav>
    <div id="layoutSidenav">

        {% include "dashboard/producer_side_panel.html" %}


        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4 display-6">{{greetings}}</h1>

                    <div class="container my-4">
                        <div class="bg-light border rounded border-0 border-light d-flex flex-column justify-content-between flex-lg-row p-4 p-md-5">
                            <div class="pb-2 pb-lg-1">
                                <h4 class="mb-2 fw-light" id="banner-title">Request Garbage Pickup</h4>
                            </div>
                        </div>
                    </div>
                      
                </div>

                <style>
                    .multisteps-form__progress {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(0, 1fr));
                      }
                      
                      .multisteps-form__progress-btn {
                        transition-property: all;
                        transition-duration: 0.15s;
                        transition-timing-function: linear;
                        transition-delay: 0s;
                        position: relative;
                        padding-top: 20px;
                        color: rgba(108, 117, 125, 0.7);
                        text-indent: -9999px;
                        border: none;
                        background-color: transparent;
                        outline: none !important;
                        cursor: pointer;
                      }
                      
                      @media (min-width: 500px) {
                        .multisteps-form__progress-btn {
                          text-indent: 0;
                        }
                      }
                      
                      .multisteps-form__progress-btn:before {
                        position: absolute;
                        top: 0;
                        left: 50%;
                        display: block;
                        width: 13px;
                        height: 13px;
                        content: '';
                        -webkit-transform: translateX(-50%);
                        transform: translateX(-50%);
                        transition: all 0.15s linear 0s, -webkit-transform 0.15s cubic-bezier(0.05, 1.09, 0.16, 1.4) 0s;
                        transition: all 0.15s linear 0s, transform 0.15s cubic-bezier(0.05, 1.09, 0.16, 1.4) 0s;
                        transition: all 0.15s linear 0s, transform 0.15s cubic-bezier(0.05, 1.09, 0.16, 1.4) 0s, -webkit-transform 0.15s cubic-bezier(0.05, 1.09, 0.16, 1.4) 0s;
                        border: 2px solid currentColor;
                        border-radius: 50%;
                        background-color: #fff;
                        box-sizing: border-box;
                        z-index: 3;
                      }
                      
                      .multisteps-form__progress-btn:after {
                        position: absolute;
                        top: 5px;
                        left: calc(-50% - 13px / 2);
                        transition-property: all;
                        transition-duration: 0.15s;
                        transition-timing-function: linear;
                        transition-delay: 0s;
                        display: block;
                        width: 100%;
                        height: 2px;
                        content: '';
                        background-color: currentColor;
                        z-index: 1;
                      }
                      
                      .multisteps-form__progress-btn:first-child:after {
                        display: none;
                      }
                      
                      .multisteps-form__progress-btn.js-active {
                        color: #007bff;
                      }
                      
                      .multisteps-form__progress-btn.js-active:before {
                        -webkit-transform: translateX(-50%) scale(1.2);
                        transform: translateX(-50%) scale(1.2);
                        background-color: currentColor;
                      }
                      
                      .multisteps-form__form {
                        position: relative;
                      }
                      
                      .multisteps-form__panel {
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 0;
                        opacity: 0;
                        visibility: hidden;
                      }
                      
                      .multisteps-form__panel.js-active {
                        height: auto;
                        opacity: 1;
                        visibility: visible;
                      }
                      
                      .multisteps-form__panel[data-animation="scaleIn"] {
                        -webkit-transform: scale(0.9);
                        transform: scale(0.9);
                      }
                      
                      .multisteps-form__panel[data-animation="scaleIn"].js-active {
                        transition-property: all;
                        transition-duration: 0.2s;
                        transition-timing-function: linear;
                        transition-delay: 0s;
                        -webkit-transform: scale(1);
                        transform: scale(1);
                      }
                </style>

                <section class="bg-light">
                    <div id="multple-step-form-n" class="container overflow-hidden" style="
                      margin-top: 0px;
                      margin-bottom: 10px;
                      padding-bottom: 300px;
                      padding-top: 57px;">
                        <div id="progress-bar-button" class="multisteps-form">
                            <div class="row justify-content-center align-items-center">
                                <div class="col-12 col-lg-8 ml-auto mr-auto mb-4">
                                    <div class="multisteps-form__progress">
                                        <a class="btn multisteps-form__progress-btn js-active" role="button" title="User Info">Basic Information</a>
                                        <a class="btn multisteps-form__progress-btn" role="button" title="User Info">Payment</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="multistep-start-row" class="row">
                            <div id="multistep-start-column" class="col-12 col-lg-8 m-auto">
                                <form id="main-form" class="multisteps-form__form">
                                    <div id="single-form-next" class="multisteps-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
                                        <h3 class="text-center multisteps-form__title">Basic Information</h3>

                                        <div id="form-content" class="multisteps-form__content">
                                            
                                            <div id="input-grp-single" class="form-row mt-4">
                                                <div class="col-12">
                                                    <select class="form-control multisteps-form__input" type="text" placeholder="" name="waste-type">
                                                        <option value="0">Waste Type</option>
                                                        <option value="Plastic">Plastic</option>
                                                        <option value="Paper">Paper</option>
                                                        <option value="Glass">Glass</option>
                                                        <option value="Metal">Metal</option>
                                                        <option value="Organic">Organic</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div id="input-grp-single" class="form-row mt-4">
                                                <div class="col-12">
                                                    <input class="form-control multisteps-form__input" type="text" placeholder="House Number (to help the collector during house to house pickup)" name="hno"/>
                                                </div>
                                            </div>
                                            <div id="input-grp-single" class="form-row mt-4">
                                                <div class="col-12">
                                                    <input class="form-control multisteps-form__input" type="text" placeholder="Bin Number" name="bno"/>
                                                </div>
                                            </div>

                                            <div id="next-button" class="button-row d-flex mt-4">
                                                <button class="btn btn btn-secondary ml-auto js-btn-next" type="button" title="Next">
                                                    Next
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="single-form-next-prev-1" class="multisteps-form__panel shadow p-4 rounded bg-white"
                                        data-animation="scaleIn">
                                        <div id="form-content-2" class="multisteps-form__content">
                                            
                                            {% if account.montly is True %}
                                                <div id="input-grp-single-2" class="form-row mt-4">
                                                    <h2 class="text-center fw-light">You are subscribed to a monthly plan</h2>
                                                </div>
                                            {% else %}
                                                <div id="input-grp-single-2" class="form-row mt-4">
                                                    <h2 class="text-center fw-light">You have {{account.request_count}} requests left</h2>
                                                </div>
                                            {% endif %}
                    
                                            <div id="next-prev-buttons-1" class="button-row d-flex mt-4">
                                                <button class="btn btn btn-primary js-btn-prev" type="submit" title="Prev">Place A request</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>

                <script>
                    //DOM elements
                    const DOMstrings = {
                        stepsBtnClass: 'multisteps-form__progress-btn',
                        stepsBtns: document.querySelectorAll(`.multisteps-form__progress-btn`),
                        stepsBar: document.querySelector('.multisteps-form__progress'),
                        stepsForm: document.querySelector('.multisteps-form__form'),
                        stepsFormTextareas: document.querySelectorAll('.multisteps-form__textarea'),
                        stepFormPanelClass: 'multisteps-form__panel',
                        stepFormPanels: document.querySelectorAll('.multisteps-form__panel'),
                        stepPrevBtnClass: 'js-btn-prev',
                        stepNextBtnClass: 'js-btn-next' };
                    
                    
                    //remove class from a set of items
                    const removeClasses = (elemSet, className) => {
                    
                        elemSet.forEach(elem => {
                    
                        elem.classList.remove(className);
                    
                        });
                    
                    };
                    
                    //return exect parent node of the element
                    const findParent = (elem, parentClass) => {
                    
                        let currentNode = elem;
                    
                        while (!currentNode.classList.contains(parentClass)) {
                        currentNode = currentNode.parentNode;
                        }
                    
                        return currentNode;
                    
                    };
                    
                    //get active button step number
                    const getActiveStep = elem => {
                        return Array.from(DOMstrings.stepsBtns).indexOf(elem);
                    };
                    
                    //set all steps before clicked (and clicked too) to active
                    const setActiveStep = activeStepNum => {
                    
                        //remove active state from all the state
                        removeClasses(DOMstrings.stepsBtns, 'js-active');
                    
                        //set picked items to active
                        DOMstrings.stepsBtns.forEach((elem, index) => {
                    
                        if (index <= activeStepNum) {
                            elem.classList.add('js-active');
                        }
                    
                        });
                    };
                    
                    //get active panel
                    const getActivePanel = () => {
                    
                        let activePanel;
                    
                        DOMstrings.stepFormPanels.forEach(elem => {
                    
                        if (elem.classList.contains('js-active')) {
                    
                            activePanel = elem;
                    
                        }
                    
                        });
                    
                        return activePanel;
                    
                    };
                    
                    //open active panel (and close unactive panels)
                    const setActivePanel = activePanelNum => {
                    
                        //remove active class from all the panels
                        removeClasses(DOMstrings.stepFormPanels, 'js-active');
                    
                        //show active panel
                        DOMstrings.stepFormPanels.forEach((elem, index) => {
                        if (index === activePanelNum) {
                    
                            elem.classList.add('js-active');
                    
                            setFormHeight(elem);
                    
                        }
                        });
                    
                    };
                    
                    //set form height equal to current panel height
                    const formHeight = activePanel => {
                    
                        const activePanelHeight = activePanel.offsetHeight;
                    
                        DOMstrings.stepsForm.style.height = `${activePanelHeight}px`;
                    
                    };
                    
                    const setFormHeight = () => {
                        const activePanel = getActivePanel();
                    
                        formHeight(activePanel);
                    };
                    
                    //STEPS BAR CLICK FUNCTION
                    DOMstrings.stepsBar.addEventListener('click', e => {
                    
                        //check if click target is a step button
                        const eventTarget = e.target;
                    
                        if (!eventTarget.classList.contains(`${DOMstrings.stepsBtnClass}`)) {
                        return;
                        }
                    
                        //get active button step number
                        const activeStep = getActiveStep(eventTarget);
                    
                        //set all steps before clicked (and clicked too) to active
                        setActiveStep(activeStep);
                    
                        //open active panel
                        setActivePanel(activeStep);
                    });
                    
                    //PREV/NEXT BTNS CLICK
                    DOMstrings.stepsForm.addEventListener('click', e => {
                    
                        const eventTarget = e.target;
                    
                        //check if we clicked on `PREV` or NEXT` buttons
                        if (!(eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`) || eventTarget.classList.contains(`${DOMstrings.stepNextBtnClass}`)))
                        {
                        return;
                        }
                    
                        //find active panel
                        const activePanel = findParent(eventTarget, `${DOMstrings.stepFormPanelClass}`);
                    
                        let activePanelNum = Array.from(DOMstrings.stepFormPanels).indexOf(activePanel);
                    
                        //set active step and active panel onclick
                        if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`)) {
                        activePanelNum--;
                    
                        } else {
                    
                        activePanelNum++;
                    
                        }
                    
                        setActiveStep(activePanelNum);
                        setActivePanel(activePanelNum);
                    
                    });
                    
                    //SETTING PROPER FORM HEIGHT ONLOAD
                    window.addEventListener('load', setFormHeight, false);
                    
                    //SETTING PROPER FORM HEIGHT ONRESIZE
                    window.addEventListener('resize', setFormHeight, false);
                    
                    //changing animation via animation select !!!YOU DON'T NEED THIS CODE (if you want to change animation type, just change form panels data-attr)
                    
                    const setAnimationType = newType => {
                        DOMstrings.stepFormPanels.forEach(elem => {
                        elem.dataset.animation = newType;
                        });
                    };
                    
                    //selector onchange - changing animation
                    const animationSelect = document.querySelector('.pick-animation__select');
                    
                    animationSelect.addEventListener('change', () => {
                        const newAnimationType = animationSelect.value;
                    
                        setAnimationType(newAnimationType);
                    });
                </script>
            </main>
            
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="{% static 'dashboard/js/scripts.js' %}"></script>
</body>
{% endblock body %}
    

    
